<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Socket.IO ν…μ¤νΈ</title>
</head>
<body>
    <h1>Socket.IO ν΄λΌμ΄μ–ΈνΈ ν…μ¤νΈ</h1>
    <p>λΈλΌμ°μ €μ κ°λ°μ λ„κµ¬(F12) μ½μ†”μ„ ν™•μΈν•μ„Έμ”.</p>
    <button onclick="joinRoom()">1λ² ν€ μ±„ν…λ°© μ…μ¥</button>

    <!-- Socket.IO ν΄λΌμ΄μ–ΈνΈ λΌμ΄λΈλ¬λ¦¬ λ΅λ“ -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script>
        // --- μΈμ¦ μ •λ³΄ μ„¤μ • ---
        // 1. μ΄ λ³€μμ— ν¬μ¤νΈλ§¨μ—μ„ λ°κΈ‰λ°›μ€ μ‹¤μ  JWT ν† ν°μ„ λ¶™μ—¬λ„£μΌμ„Έμ”.
        const myAuthToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsImVtYWlsIjoibW9qYWVAbmF2ZXIuY29tIiwicm9sZSI6IlVTRVIiLCJpYXQiOjE3NTM2Mjc4MzAsImV4cCI6MTc1MzcxNDIzMH0.eec-Lx2yUjeSLbFtBc1VzsIslRhh9uUc1P2R8PtbGGU"; 

        // 2. μ„λ²„μ— μ—°κ²°ν•  λ•, auth κ°μ²΄λ¥Ό ν†µν•΄ ν† ν°μ„ μ „μ†΅ν•©λ‹λ‹¤.
        const socket = io("http://localhost:3000", {
            auth: {
                token: myAuthToken
            }
        });

        // 3. μ„λ²„ μ—°κ²° μ„±κ³µ μ‹ μ‹¤ν–‰λ©λ‹λ‹¤.
        socket.on("connect", () => {
            console.log("β… μ„λ²„μ— μ—°κ²°λμ—μµλ‹λ‹¤. μ†μΌ“ ID:", socket.id);
        });

        // 4. μ—°κ²° μ‹¤ν¨ μ‹ (μΈμ¦ μ‹¤ν¨ λ“±) μ‹¤ν–‰λ©λ‹λ‹¤.
        socket.on("connect_error", (err) => {
            console.error("β μ—°κ²° μ‹¤ν¨:", err.message);
        });

        // 5. μ„λ²„λ΅λ¶€ν„° 'system_message' μ΄λ²¤νΈλ¥Ό λ°›μ•μ„ λ• μ‹¤ν–‰λ©λ‹λ‹¤.
        socket.on("system_message", (message) => {
            console.log("π“Ά [μ„λ²„ μ‹μ¤ν… λ©”μ‹μ§€]:", message);
        });
        
        // 6. μ„λ²„λ΅λ¶€ν„° 'error_message' μ΄λ²¤νΈλ¥Ό λ°›μ•μ„ λ• μ‹¤ν–‰λ©λ‹λ‹¤.
        socket.on("error_message", (message) => {
            console.error("β [μ„λ²„ μ—λ¬ λ©”μ‹μ§€]:", message);
        });

        // 7. μ„λ²„ μ—°κ²°μ΄ λμ–΄μ΅μ„ λ• μ‹¤ν–‰λ©λ‹λ‹¤.
        socket.on("disconnect", () => {
            console.log("π” μ„λ²„μ™€μ μ—°κ²°μ΄ λμ–΄μ΅μµλ‹λ‹¤.");
        });

        // λ²„νΌ ν΄λ¦­ μ‹ 'join_room' μ΄λ²¤νΈλ¥Ό μ„λ²„λ΅ λ³΄λƒ…λ‹λ‹¤.
        function joinRoom() {
            const teamIdToJoin = 1; // ν…μ¤νΈν•  ν€ ID
            console.log(`π€ ${teamIdToJoin}λ² ν€ μ…μ¥μ„ μ”μ²­ν•©λ‹λ‹¤...`);
            socket.emit("join_room", { teamId: teamIdToJoin });
        }
    </script>
</body>
</html>
